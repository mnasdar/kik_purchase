import{$ as t}from"./jquery-2823516c.js";import{f as d}from"./index-a4e39586.js";import{I as p}from"./id-ec13cc1f.js";import{s as m}from"./index-88056f3d.js";import{s as l,d as f}from"./notification-0e55581f.js";import"./_commonjsHelpers-725317a4.js";import"./parse-c3570fb2.js";import"./pembayaran-edit-5f085df9.js";d.localize(p);t(document).ready(function(){g()});function g(){v(),b()}function v(){document.querySelectorAll(".date-picker-field").forEach(n=>{d(n,{dateFormat:"Y-m-d",locale:"id",altInput:!0,altFormat:"d-M-Y",allowInput:!0})})}function b(){const r=t("#bulk-edit-form");r.on("submit",function(n){n.preventDefault();const o=t('input[name="ids"]').val().split(",").filter(c=>c),a=t("#bulk_invoice_number").val()||null,e=t("#bulk_invoice_received_at").val(),i=t("#bulk_sla_target").val();if(!e||!e.trim()){l("Tanggal diterima harus diisi","warning",2e3);return}if(!i||parseInt(i)<1){l("Target SLA harus minimal 1 hari","warning",2e3);return}const s={};o.forEach(c=>{s[c]={invoice_number:a?a.trim():null,invoice_received_at:e,sla_target:parseInt(i)}});const u={ids:o,invoice_data:s};console.log("Updating invoices:",u),_(u,r)})}function _(r,n){const o=n.find('button[type="submit"]'),a=o.html();o.prop("disabled",!0).html('<i class="mgc_loader_2_line animate-spin"></i> Mengupdate...'),t.ajax({url:m("dari-vendor.bulk-update"),method:"POST",contentType:"application/json",data:JSON.stringify(r),headers:{"X-CSRF-TOKEN":t('meta[name="csrf-token"]').attr("content")},success:function(e){console.log("Success response:",e),l(e.message||"Invoice berhasil diupdate!","success",2e3),setTimeout(()=>{window.location.href=e.redirect||m("dari-vendor.index")},1500)},error:function(e){console.error("Error response:",e);let i="Gagal mengupdate invoice";e.responseJSON&&(e.responseJSON.message?i=e.responseJSON.message:e.responseJSON.errors&&(i=Object.values(e.responseJSON.errors).flat().join(", "))),f(i,"Error!")},complete:function(){o.prop("disabled",!1).html(a)}})}
