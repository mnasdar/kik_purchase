import{$ as t}from"./jquery-2823516c.js";import{a as f,b as a}from"./gridjs.module-3ea5c5ab.js";import{s as r}from"./index-88056f3d.js";import{t as h}from"./tippy.all-093076db.js";import{s as c,d as m}from"./notification-0e55581f.js";import"./_commonjsHelpers-725317a4.js";import"./parse-c3570fb2.js";import"./pembayaran-edit-5f085df9.js";let d=null;function p(){return[{id:"checkbox",name:a("div",{innerHTML:'<input type="checkbox" id="headerCheck" class="form-checkbox rounded text-primary">'}),width:"50px",sort:!1,formatter:e=>a("div",{innerHTML:e})},{id:"number",name:"#",width:"60px"},{id:"invoice_number",name:"Invoice Number",width:"140px",formatter:e=>a("div",{innerHTML:e})},{id:"po_number",name:"PO Number",width:"140px",formatter:e=>a("div",{innerHTML:e})},{id:"pr_number",name:"PR Number",width:"140px",formatter:e=>a("div",{innerHTML:e})},{id:"item_desc",name:"Item Description",width:"300px",formatter:e=>a("div",{innerHTML:e})},{id:"unit_price",name:"Unit Price",width:"120px",formatter:e=>a("div",{innerHTML:`<span class="font-semibold text-slate-700 dark:text-slate-300">${e}</span>`})},{id:"qty",name:"Qty",width:"70px",formatter:e=>a("div",{innerHTML:`<span class="font-semibold text-center block">${e}</span>`})},{id:"amount",name:"Amount",width:"120px",formatter:e=>a("div",{innerHTML:`<span class="font-semibold text-green-600 dark:text-green-400">${e}</span>`})},{id:"onsite_date",name:"Tgl PO Onsite",width:"130px",formatter:e=>a("div",{innerHTML:e})},{id:"sla_target",name:a("div",{className:"whitespace-normal",innerHTML:"SLA Target"}),width:"80px",formatter:e=>a("div",{innerHTML:e})},{id:"current_stage",name:"Status",width:"120px",formatter:e=>a("div",{innerHTML:e})},{id:"created_by",name:a("div",{className:"whitespace-normal",innerHTML:"Created By"}),width:"100px",formatter:e=>a("div",{innerHTML:e})}]}function u(e=!1){t.ajax({url:r("dari-vendor.data"),method:"GET",beforeSend:function(){e&&c("Memuat data...","info",1e3)},success:function(n){const i=n.map(o=>[`<input type="checkbox" class="form-checkbox rounded text-primary" value="${o.id}">`,o.number,`<span class="font-semibold text-slate-700 dark:text-slate-300">${o.invoice_number}</span>`,`<span class="font-semibold text-primary">${o.po_number}</span>`,o.pr_number,o.item_desc,o.unit_price,o.qty,o.amount,o.onsite_date,o.sla_invoice_to_finance_target,o.current_stage,o.created_by]);d?d.updateConfig({data:i}).forceRender():d=new f({columns:p(),data:i,sort:!0,pagination:{enabled:!0,limit:10},search:!0,className:{table:"table-auto w-full",thead:"bg-slate-100 dark:bg-slate-800",th:"px-4 py-3 text-left text-xs font-medium text-slate-700 dark:text-slate-300",td:"px-4 py-3 text-sm text-slate-900 dark:text-slate-100"}}).render(document.getElementById("table-invoice")),t("#data-count").text(n.length),setTimeout(()=>{h("[data-tippy-content]",{arrow:!0,placement:"top"}),k()},100),e&&c("Data berhasil dimuat!","success",1500)},error:function(){m("Gagal memuat data invoice","Error!")}})}function k(){t(document).off("change","#headerCheck").on("change","#headerCheck",function(){const e=t(this).is(":checked");t(".form-checkbox").not(this).prop("checked",e),s()}),t(document).off("change",".form-checkbox").on("change",".form-checkbox",function(){const e=t(".form-checkbox").not("#headerCheck").length===t(".form-checkbox:checked").not("#headerCheck").length;t("#headerCheck").prop("checked",e),s()})}function s(){const e=t(".form-checkbox:checked").not("#headerCheck").length,n=t("#btn-delete-selected"),i=t("#btn-edit-selected");e>0?(n.removeClass("hidden"),i.removeClass("hidden"),t("#delete-count").text(e),t("#edit-count").text(e)):(n.addClass("hidden"),i.addClass("hidden"))}function b(){t(document).off("click","#btn-edit-selected").on("click","#btn-edit-selected",function(){const e=t(".form-checkbox:checked").not("#headerCheck").map(function(){return t(this).val()}).get();if(e.length===0){c("Pilih minimal 1 item untuk diedit","warning",2e3);return}const n=e.join(",");window.location.href=r("dari-vendor.bulk-edit",{ids:n})})}function x(){t("#table-invoice").length&&u(!1)}function g(){t(document).off("click","#btn-refresh").on("click","#btn-refresh",function(){u(!0)})}function v(){t(document).off("click","#btn-delete-selected").on("click","#btn-delete-selected",function(){const e=t(".form-checkbox:checked").not("#headerCheck").map(function(){return t(this).val()}).get();if(e.length===0){c("Pilih minimal 1 item untuk dihapus","warning",2e3);return}M(e)})}function M(e){const n=t("#deleteModal"),i=t("#deleteModalBackdrop"),o=t("#deleteModalContent");t("#deleteMessage").text(`Apakah Anda yakin ingin menghapus ${e.length} data invoice?`),n.removeClass("hidden"),n.css("opacity","1"),setTimeout(()=>{i.css("opacity","1"),o.css({transform:"scale(1)",opacity:"1"})},10),t("#deleteModalConfirm").off("click").on("click",function(){T(e),l()}),t("#deleteModalCancel, #deleteModalBackdrop").off("click").on("click",function(){l()})}function l(){const e=t("#deleteModalBackdrop"),n=t("#deleteModalContent"),i=t("#deleteModal");e.css("opacity","0"),n.css({transform:"scale(0.95)",opacity:"0"}),setTimeout(()=>{i.addClass("hidden").css("opacity","0")},300)}function T(e){t.ajax({url:r("dari-vendor.bulkDestroy"),method:"DELETE",data:{ids:e},headers:{"X-CSRF-TOKEN":t('meta[name="csrf-token"]').attr("content")},success:function(n){c(n.message,"success",2e3),setTimeout(()=>location.reload(),500)},error:function(n){var i;m(((i=n==null?void 0:n.responseJSON)==null?void 0:i.message)||"Gagal menghapus invoice","Error!")}})}t(document).ready(function(){x(),g(),b(),v()});
