import{$ as e}from"./jquery-2823516c.js";import{S as g}from"./sweetalert2.all-5f085df9.js";import{s as b}from"./index-88056f3d.js";import{f as j}from"./index-a4e39586.js";import"./_commonjsHelpers-725317a4.js";import"./parse-c3570fb2.js";const F=window.location.pathname,I=F.split("/"),T=I[1];function p(w){const{resourceName:m,params:h,editButtonSelector:B,submitButtonSelector:M,loaderOverlaySelector:A,dateId:k}=w,i=e("#editItemForm"),y=e("#editModal"),O=e(".btn-edit"),l=e("#btnUpdate"),$=l.find(".loader"),C=e("#loaderOverlay");let s={};function S(){C.removeClass("hidden").addClass("flex")}function x(){C.removeClass("flex").addClass("hidden")}function D(){y.removeClass("hidden"),e("body").addClass("overflow-hidden")}function N(){y.addClass("hidden"),e("body").removeClass("overflow-hidden"),s={}}i.on("input change","input, select",function(){let r=!1;i.find("input, select").each(function(){const c=e(this),n=c.attr("name");if(n&&s.hasOwnProperty(n)&&c.val()!==s[n])return r=!0,!1}),l.prop("disabled",!r)}),O.on("click",function(){const r=e('input[type="checkbox"]:not([id^="headerCheck"]):checked');if(r.length===1){const c=r.val(),n=h?b(`${m}.edit`,[h,c]):b(`${m}.edit`,c);S(),e.ajax({url:n,method:"GET",dataType:"json",success:function(d){Array.isArray(k)&&k.forEach(function(t){const o=e(t);if(o.length){const a=o.attr("name");a&&d[a]&&j(t,{defaultDate:new Date(d[a]),dateFormat:"Y-m-d",altInput:!0,altFormat:"d-M-Y"})}}),s={},i.find("input change,input, select").each(function(){const t=e(this),o=t.attr("name");if(o&&(s[o]=t.val()),o&&Object.prototype.hasOwnProperty.call(d,o)){const a=d[o];if(t.is("select")){t.val(a),t.find("option").prop("selected",!1),t.find(`option[value="${a}"]`).prop("selected",!0),t.trigger("change");const f=t.next(".nice-select"),v=f.find(".option");v.removeClass("selected focus");const u=v.filter(`[data-value="${a}"]`);u.addClass("selected focus"),f.find(".current").text(u.text())}else t.val(a)}}),s={},i.find("input, select").each(function(){const t=e(this),o=t.attr("name");o&&(s[o]=t.val())}),l.prop("disabled",!0),x(),D()},error:function(){x(),g.fire({icon:"error",title:"Oops...",text:"Gagal mengambil data! Silakan coba lagi."})}})}}),i.on("submit",function(r){r.preventDefault();const c=new FormData(this),n=e('input[type="checkbox"]:not([id^="headerCheck"]):checked');if(n.length===1){const d=n.val(),t=h?b(`${m}.update`,[h,d]):b(`${m}.update`,d);l.prop("disabled",!0),$.removeClass("hidden"),e.ajax({url:t,method:"POST",headers:{"X-CSRF-TOKEN":e('meta[name="csrf-token"]').attr("content"),Accept:"application/json"},data:c,processData:!1,contentType:!1,success:function(){i.find(".error-message").text(""),g.fire({icon:"success",title:"Berhasil",text:"Data berhasil diperbarui",timer:1500,showConfirmButton:!1}),N(),setTimeout(()=>location.reload(),1500)},error:function(o){if(o.status===422){const a=o.responseJSON.errors||{};i.find(".error-message").text("");for(const f in a){const v=a[f][0],u=e(`#error-edit-${f}`);u.length&&u.text(v)}}else g.fire({icon:"error",title:"Gagal",text:"Terjadi kesalahan saat memperbarui data."})},complete:function(){l.prop("disabled",!1),$.addClass("hidden")}})}})}e(document).ready(function(){e("#onsite-table").length&&p({resourceName:"po-onsite",params:T,dateId:["#editReceivedAt"]}),e("#dari_vendor-table").length&&p({resourceName:"dari-vendor",dateId:["#editInvoiceDate","#editReceivedAt"]}),e("#status-table").length&&p({resourceName:"status"}),e("#classification-table").length&&p({resourceName:"klasifikasi"}),e("#location-table").length&&p({resourceName:"unit-kerja"})});
