import{$ as t}from"./modal-handler-2823516c.js";import{a as l,b as n}from"./gridjs.module-3ea5c5ab.js";import{s}from"./index-88056f3d.js";import{t as h}from"./tippy.all-093076db.js";import{s as o,a as u}from"./notification-d92c8c7c.js";import"./_commonjsHelpers-725317a4.js";import"./parse-c3570fb2.js";import"./notification-5f085df9.js";let r=null;function f(){return[{id:"checkbox",name:n("div",{innerHTML:'<input type="checkbox" id="headerCheck" class="form-checkbox rounded text-primary">'}),width:"50px",sort:!1,formatter:e=>n("div",{innerHTML:e})},{id:"number",name:"#",width:"60px"},{id:"invoice_number",name:"Invoice Number",width:"140px",formatter:e=>n("div",{innerHTML:e})},{id:"po_number",name:"PO Number",width:"140px",formatter:e=>n("div",{innerHTML:e})},{id:"pr_number",name:"PR Number",width:"140px",formatter:e=>n("div",{innerHTML:e})},{id:"item_desc",name:"Item Description",width:"250px",formatter:e=>n("div",{innerHTML:e})},{id:"unit_price",name:"Unit Price",width:"120px",formatter:e=>n("div",{innerHTML:`<span class="font-semibold text-slate-700 dark:text-slate-300">${e}</span>`})},{id:"qty",name:"Qty",width:"80px",formatter:e=>n("div",{innerHTML:`<span class="font-semibold text-center block">${e}</span>`})},{id:"amount",name:"Amount",width:"120px",formatter:e=>n("div",{innerHTML:`<span class="font-semibold text-green-600 dark:text-green-400">${e}</span>`})},{id:"invoice_received_at",name:"Tgl Diterima",width:"120px",formatter:e=>n("div",{innerHTML:e})},{id:"invoice_submitted_at",name:"Tgl Diajukan",width:"120px",formatter:e=>n("div",{innerHTML:e})},{id:"sla_target",name:n("div",{className:"whitespace-normal",innerHTML:"SLA Target"}),width:"70px",formatter:e=>n("div",{innerHTML:e})},{id:"sla_realization",name:n("div",{className:"whitespace-normal",innerHTML:"SLA Realisasi"}),width:"70px",formatter:e=>n("div",{innerHTML:e})},{id:"created_by",name:n("div",{className:"whitespace-normal",innerHTML:"Created By"}),width:"100px",formatter:e=>n("div",{innerHTML:e})}]}function m(e=!1){t.ajax({url:s("pengajuan.history-data"),method:"GET",beforeSend:function(){e&&o("Memuat data...","info",1e3)},success:function(i){const d=i.map(a=>[`<input type="checkbox" class="form-checkbox rounded text-primary" value="${a.id}">`,a.number,`<span class="font-semibold text-slate-700 dark:text-slate-300">${a.invoice_number}</span>`,`<span class="font-semibold text-primary">${a.po_number}</span>`,a.pr_number,a.item_desc,a.unit_price,a.qty,a.amount,a.invoice_received_at,a.invoice_submitted_at,a.sla_target,a.sla_realization,a.created_by]);r?r.updateConfig({data:d}).forceRender():r=new l({columns:f(),data:d,sort:!0,pagination:{enabled:!0,limit:10},search:!0,className:{table:"table-auto w-full",thead:"bg-slate-100 dark:bg-slate-800",th:"px-4 py-3 text-left text-xs font-medium text-slate-700 dark:text-slate-300",td:"px-4 py-3 text-sm text-slate-900 dark:text-slate-100"}}).render(document.getElementById("table-history")),t("#data-count").text(i.length),t("#headerCheck").prop("checked",!1),t("#btn-edit-selected").addClass("hidden"),t("#edit-count").text(0),setTimeout(()=>{h("[data-tippy-content]",{arrow:!0,placement:"top"}),p()},100),e&&o("Data berhasil dimuat!","success",1500)},error:function(){u("Gagal memuat data pengajuan","Error!")}})}function p(){t(document).off("change","#headerCheck").on("change","#headerCheck",function(){const e=t(this).is(":checked");t(".form-checkbox").not(this).prop("checked",e),c()}),t(document).off("change",".form-checkbox").on("change",".form-checkbox",function(){const e=t(".form-checkbox").not("#headerCheck").length===t(".form-checkbox:checked").not("#headerCheck").length;t("#headerCheck").prop("checked",e),c()})}function c(){const e=t(".form-checkbox:checked").not("#headerCheck").length,i=t("#btn-edit-selected");e>0?(i.removeClass("hidden"),t("#edit-count").text(e)):i.addClass("hidden")}function b(){return t(".form-checkbox:checked").not("#headerCheck").map(function(){return t(this).val()}).get()}function x(){t(document).off("click","#btn-edit-selected").on("click","#btn-edit-selected",function(){const e=b();if(e.length===0){o("Pilih minimal 1 item untuk diedit","warning",2e3);return}const i=e.join(",");window.location.href=s("pengajuan.bulk-edit",{ids:i})})}function k(){t("#table-history").length&&m(!1)}function g(){t(document).off("click","#btn-refresh").on("click","#btn-refresh",function(){m(!0)})}t(document).ready(function(){k(),g(),x()});
