import{$ as e}from"./modal-handler-2823516c.js";import{s as h}from"./index-88056f3d.js";import{f as m}from"./index-a4e39586.js";import{s as c,a as g}from"./notification-d92c8c7c.js";import"./_commonjsHelpers-725317a4.js";import"./parse-c3570fb2.js";import"./notification-5f085df9.js";let d=null;function i(n){const t=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),o=String(n.getDate()).padStart(2,"0");return`${t}-${a}-${o}`}function p(){const n=new Date,t=new Date(n.getFullYear(),n.getMonth(),1);d=m("#date_range",{mode:"range",dateFormat:"d M Y",defaultDate:[t,n],maxDate:n,locale:{firstDayOfWeek:1,rangeSeparator:" s/d ",weekdays:{shorthand:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],longhand:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"]},months:{shorthand:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],longhand:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"]}},onChange:function(o){o.length===2?(e("#start_date").val(i(o[0])),e("#end_date").val(i(o[1]))):o.length===1&&(e("#start_date").val(i(o[0])),e("#end_date").val(""))},onClose:function(o){o.length===2&&(e("#start_date").val(i(o[0])),e("#end_date").val(i(o[1])))}});const a=d.selectedDates;a.length===2&&(e("#start_date").val(i(a[0])),e("#end_date").val(i(a[1])))}function D(){e(".btn-quick-filter").on("click",function(){const n=e(this).data("period"),t=b(n);t&&(d.setDate([t.start,t.end]),c(`Filter diatur ke: ${e(this).text().trim()}`,"success",1500))})}function b(n){const t=new Date,a={start:null,end:t};switch(n){case"today":a.start=t;break;case"yesterday":a.start=new Date(t.getTime()-1*24*60*60*1e3),a.end=a.start;break;case"this-week":const o=new Date(t);o.setDate(t.getDate()-t.getDay()+1),a.start=o;break;case"last-week":const r=new Date(t);r.setDate(t.getDate()-t.getDay());const s=new Date(r);s.setDate(r.getDate()-6),a.start=s,a.end=r;break;case"this-month":a.start=new Date(t.getFullYear(),t.getMonth(),1);break;case"last-month":const u=new Date(t.getFullYear(),t.getMonth()-1,1);a.start=u,a.end=new Date(t.getFullYear(),t.getMonth(),0);break;case"last-30-days":a.start=new Date(t.getTime()-30*24*60*60*1e3);break;case"this-year":a.start=new Date(t.getFullYear(),0,1);break;default:return null}return a}function y(){e("#export-loading-overlay").removeClass("hidden"),e("body").css("overflow","hidden")}function k(){e("#export-loading-overlay").addClass("hidden"),e("body").css("overflow","auto")}function v(){e("#form-export").on("submit",function(n){n.preventDefault();const t=e("#start_date").val(),a=e("#end_date").val(),o=e("#filter_type").val(),r=e("#export_location").val();if(!t||!a){g("Mohon pilih rentang tanggal","Validasi Error");return}if(!o){g("Mohon pilih tipe filter (PR atau PO)","Validasi Error");return}y();const s=e("#btn-export"),u=s.html();s.prop("disabled",!0).html('<i class="mgc_loading_line animate-spin"></i> Mengexport...');let f=h("export.data")+"?start_date="+t+"&end_date="+a+"&filter_type="+o;r&&(f+="&location_id="+r);const l=document.createElement("a");l.href=f,l.style.display="none",document.body.appendChild(l),l.click(),setTimeout(()=>{k(),c("Export berhasil! File akan segera diunduh.","success",3e3),s.prop("disabled",!1).html(u),document.body.removeChild(l)},2e3)})}function w(){e("#btn-reset").on("click",function(){const n=new Date,t=new Date(n.getFullYear(),n.getMonth(),1);d.setDate([t,n]),e("#filter_type").val("pr");const a=e("#export_location");a.is(":disabled")||a.val(""),c("Form direset ke default (bulan ini)","info",1500)})}function _(){e("#clear-date-range").on("click",function(){d.clear(),e("#start_date").val(""),e("#end_date").val(""),c("Pilihan tanggal dihapus","info",1500)})}e(document).ready(function(){p(),D(),v(),w(),_()});
