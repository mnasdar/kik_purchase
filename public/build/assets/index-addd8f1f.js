import{$ as t}from"./jquery-2823516c.js";import{a as p,b as a}from"./gridjs.module-3ea5c5ab.js";import{s as u}from"./index-88056f3d.js";import{t as b}from"./tippy.all-093076db.js";import{s as r,d as f}from"./notification-0e55581f.js";import"./_commonjsHelpers-725317a4.js";import"./parse-c3570fb2.js";import"./pembayaran-edit-5f085df9.js";let c=null;function k(){return[{id:"checkbox",name:a("div",{innerHTML:'<input type="checkbox" id="headerCheck" class="form-checkbox rounded text-primary">'}),width:"50px",sort:!1,formatter:e=>a("div",{innerHTML:e})},{id:"number",name:"#",width:"60px"},{id:"invoice_number",name:"Invoice Number",width:"140px",formatter:e=>a("div",{innerHTML:e})},{id:"po_number",name:"PO Number",width:"140px",formatter:e=>a("div",{innerHTML:e})},{id:"pr_number",name:"PR Number",width:"140px",formatter:e=>a("div",{innerHTML:e})},{id:"item_desc",name:"Item Description",width:"250px",formatter:e=>a("div",{innerHTML:e})},{id:"unit_price",name:"Unit Price",width:"120px",formatter:e=>a("div",{innerHTML:`<span class="font-semibold text-slate-700 dark:text-slate-300">${e}</span>`})},{id:"qty",name:"Qty",width:"80px",formatter:e=>a("div",{innerHTML:`<span class="font-semibold text-center block">${e}</span>`})},{id:"amount",name:"Amount",width:"120px",formatter:e=>a("div",{innerHTML:`<span class="font-semibold text-green-600 dark:text-green-400">${e}</span>`})},{id:"onsite_date",name:"Tgl PO Onsite",width:"120px",formatter:e=>a("div",{innerHTML:e})},{id:"invoice_received_at",name:"Tgl Diterima",width:"120px",formatter:e=>a("div",{innerHTML:e})},{id:"sla_target",name:a("div",{className:"whitespace-normal",innerHTML:"SLA Target"}),width:"70px",formatter:e=>a("div",{innerHTML:e})},{id:"sla_realization",name:a("div",{className:"whitespace-normal",innerHTML:"SLA Realisasi"}),width:"70px",formatter:e=>a("div",{innerHTML:e})},{id:"created_by",name:a("div",{className:"whitespace-normal",innerHTML:"Created By"}),width:"100px",formatter:e=>a("div",{innerHTML:e})}]}function d(e=!1){t.ajax({url:u("pengajuan.data"),method:"GET",beforeSend:function(){e&&r("Memuat data...","info",1e3)},success:function(i){const o=i.map(n=>[`<input type="checkbox" class="form-checkbox rounded text-primary" value="${n.id}">`,n.number,`<span class="font-semibold text-slate-700 dark:text-slate-300">${n.invoice_number}</span>`,`<span class="font-semibold text-primary">${n.po_number}</span>`,n.pr_number,n.item_desc,n.unit_price,n.qty,n.amount,n.onsite_date,n.invoice_received_at,n.sla_target,n.sla_realization,n.created_by]);c?c.updateConfig({data:o}).forceRender():c=new p({columns:k(),data:o,sort:!0,pagination:{enabled:!0,limit:10},search:!0,className:{table:"table-auto w-full",thead:"bg-slate-100 dark:bg-slate-800",th:"px-4 py-3 text-left text-xs font-medium text-slate-700 dark:text-slate-300",td:"px-4 py-3 text-sm text-slate-900 dark:text-slate-100"}}).render(document.getElementById("table-pengajuan")),t("#data-count").text(i.length),t("#headerCheck").prop("checked",!1),t("#btn-submit-selected").addClass("hidden"),t("#submit-count").text(0),setTimeout(()=>{b("[data-tippy-content]",{arrow:!0,placement:"top"}),g()},100),e&&r("Data berhasil dimuat!","success",1500)},error:function(){f("Gagal memuat data pengajuan","Error!")}})}function g(){t(document).off("change","#headerCheck").on("change","#headerCheck",function(){const e=t(this).is(":checked");t(".form-checkbox").not(this).prop("checked",e),l()}),t(document).off("change",".form-checkbox").on("change",".form-checkbox",function(){const e=t(".form-checkbox").not("#headerCheck").length===t(".form-checkbox:checked").not("#headerCheck").length;t("#headerCheck").prop("checked",e),l()})}function l(){const e=t(".form-checkbox:checked").not("#headerCheck").length,i=t("#btn-submit-selected");e>0?(i.removeClass("hidden"),t("#submit-count").text(e)):i.addClass("hidden")}function s(e=!1){const i=t("#submitModal"),o=t("#submitModalBackdrop"),n=t("#submitModalContent");e?(i.removeClass("hidden"),setTimeout(()=>{i.css("opacity",1),o.css("opacity",1),n.css({opacity:1,transform:"scale(1)"})},10)):(i.css("opacity",0),o.css("opacity",0),n.css({opacity:0,transform:"scale(0.95)"}),setTimeout(()=>i.addClass("hidden"),200))}function h(){return t(".form-checkbox:checked").not("#headerCheck").map(function(){return t(this).val()}).get()}function x(){const e=h(),i=t("#invoice_submitted_at").val();if(e.length===0){r("Pilih minimal 1 invoice","warning",1500);return}if(!i){r("Isi tanggal pengajuan","warning",1500);return}t.ajax({url:u("pengajuan.bulk-submit"),method:"POST",data:{ids:e,invoice_submitted_at:i},beforeSend:function(){r("Mengirim pengajuan...","info",1200)},success:function(o){r(o.message||"Berhasil diajukan","success",1500),s(!1),d(!1)},error:function(o){var m;const n=((m=o.responseJSON)==null?void 0:m.message)||"Gagal mengajukan invoice";f(n,"Error!")}})}function v(){t(document).off("click","#btn-submit-selected").on("click","#btn-submit-selected",function(){const e=h();if(e.length===0){r("Pilih minimal 1 invoice","warning",1500);return}t("#submitMessage").text(`Anda akan mengajukan ${e.length} invoice ke finance.`),s(!0)}),t(document).off("click","#submitModalCancel").on("click","#submitModalCancel",function(){s(!1)}),t(document).off("click","#submitModalConfirm").on("click","#submitModalConfirm",function(){x()})}function T(){t("#table-pengajuan").length&&d(!1)}function M(){t(document).off("click","#btn-refresh").on("click","#btn-refresh",function(){d(!0)})}t(document).ready(function(){T(),M(),v()});
